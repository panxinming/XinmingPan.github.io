---
layout: post
title: Logistic Regression
---

Here I want to talk about one Machine Learning Model, Logistic Regression.\
Logistic regression models the probabilities for classification problems with two possible outcomes. Itâ€™s an extension of the linear regression model for classification problems.


***So, Here I want to ask one question.***
> Why not choose Linear Regression for Classification?

> **Answer:** The linear regression model can work well for regression, but fails for classification. Why is that? In case of two classes, you could label one of the classes with 0 and the other with 1 and use linear regression. Technically it works and most linear model programs will spit out weights for you. But there are a few problems with this approach: A linear model does not output probabilities, but it treats the classes as numbers (0 and 1) and fits the best hyperplane (for a single feature, it is a line) that minimizes the distances between the points and the hyperplane [(Least Square Method)](https://en.wikipedia.org/wiki/Least_squares). So it simply interpolates between the points, and you cannot interpret it as probabilities.


Now, let's compare Linear Regression and Logistic Regression.

Here, I load the **iris** data as our example.

## 1. Linear Regression

Load our data first in Python.
```python
import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sb

# import some data to play with
iris = pd.read_csv("iris.csv")
iris
```

{% include iris.html %}

After doing some data cleaning, then we draw the scatter plot.
```python
# Only consider the Species "versicolor" and "virginica"
iris = iris[iris["Species"] != "setosa"]
iris["Species"] = iris["Species"].replace(["versicolor", "virginica"], [0,1])

# Create Variables X and Y
x = iris["Sepal.Length"]
y = iris["Species"]
# Create the scatter plot
sb.scatterplot(x,y)
```

![iris.lm.1.png]({{ site.baseurl }}/images/iris.lm.1.png)


Then, we are going to draw the linear regression line.
```python
sb.regplot(x,y, ci = None)
```

![iris.lm.2.png]({{ site.baseurl }}/images/iris.lm.2.png)

> Here, we can see the **Linear Regression** line doesn't fit the plot very much. So, now let's see if **Logistic Regression** can do better.


## 2. Logistic Regression

Before we draw the Logistic Regression line, I want to introduce some **mathematical** knowledge of Logistic Regression.

Logistic Regression gives the probability of an event occurring, not just the predicted classification.

Odds means a ratio between the probability of the event you want to happen and the probability of the event you don't want to happen.

$$odds = \frac{P}{1-P}$$